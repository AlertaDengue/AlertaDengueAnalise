Organização dos dados do tweet RJ
===================================
Concatena os dados mais recentes com a serie historica. Sao precisos 3 dados de entrada:
- serie historica em semanas (a mais atualizada que tiver)
- ultima serie de tweets recem-recebidos, diarios
- penultima serie de tweets diarios (necessario porque as vezes a semana epidemiologica nao fecha direitinho) 


```{r, echo=FALSE}
# funcoes criadas para o projeto
source("../fun/data2SE.r")
source("../fun/concatweet.r")
```


Dados 
-----

**Serie historica de tweets por semana (2010-2013):**
```{r}
dant<-read.csv("../dados_limpos/tweets_week_2010-2013.csv")
```

**Serie de 2014 de tweets diarios:**
```{r}
comando<-paste("../fun/pega_tweets.py -i 2014-01-05 -f ",Sys.Date()) # primeira SE de 2014 ate hoje
system(comando)
d<-read.csv("tweets_teste.csv",header=TRUE)[,1:2]
names(d)[2]<-"rio"
```

Concatenacao
------------

Concatenar as series diarias, preenchendo com NA, se necessario.
```{r echo=FALSE}
d<-concatweet(d1,d2)
d$SE<-data2SE(d$data,file="../tabelas/SE.csv",format="%Y-%m-%d")   
```

```{r echo=FALSE}
ult<-sum(d$SE==max(d$SE))
pri<-sum(d$SE==min(d$SE))
```

A serie tem `r pri` dias na primeira semana e `r ult` dias na ultima semana. Serao removidos.

**Tweets/semana**
```{r echo=FALSE}
dsem<-aggregate(d$rio,by=list(SE=d$SE),FUN=sum,na.rm=TRUE)
names(dsem)[2]<-"tweets"
if (ult<7) dsem<-dsem[-(dim(dsem)[1]),]
if (pri<7) dsem<-dsem[-1,]
dsem
```

```{r echo=FALSE}
twRJ <- rbind(dant[,2:3],dsem)
```

```{r echo=FALSE}
plot(twRJ$SE,twRJ$tweets,ylab="tweets",xlab="semana",main="Serie temporal completa 2010-2014")
```

Salvar
------

```{r}
write.table(twRJ,file="../dados_limpos/tweetsemanaRJ.csv",sep=",",row.names=FALSE)
```

